import{u as A,_ as M,a as P}from"./QuestionImportExport-OeHxXhkL.js";import{q as U}from"./question-ChUrMfMN.js";import{_ as L,r as n,a as h,b as a,c as l,w as c,k as i,d,e as m,h as j,t as k,i as g,g as F,p as G}from"./index-BYh7zG4k.js";const H={class:"choice-questions"},J={class:"header"},K={key:0,class:"question-content"},W={class:"question-title"},X={class:"question-answer"},Y={class:"answer-content"},Z={key:0,class:"question-note"},ee={class:"explanation-content"},te=["onClick"],ae={__name:"EssayQuestions",setup(se){const Q=[{title:"题目内容",dataIndex:"title",key:"title",ellipsis:!0},{title:"分值",dataIndex:"score",key:"score",width:80,align:"center",customRender:({text:t})=>`${t}分`},{title:"操作",key:"action",width:150,fixed:"right"}],v=A(),y=n(!1),p=n(!1),f=n("新增简答题"),w=n(null),_=n(null),q=n([]),x=n(0),s=n({current:1,size:10,type:1,keyword:""}),r=async()=>{y.value=!0;try{const t=await U.getQuestionList({...s.value,type:1});q.value=t.items.records,x.value=t.items.total}catch{i.error("获取题目列表失败")}finally{y.value=!1}},b=()=>{s.value.current=1,r()},S=(t,e)=>{s.value={...s.value,current:t,size:e},r()},z=()=>{f.value="新增简答题",_.value=null,p.value=!0},$=t=>{f.value="编辑简答题",_.value=G(t),p.value=!0},I=async t=>{try{await v.deleteQuestion(t),i.success("删除成功"),r()}catch{i.error("删除失败")}},V=async t=>{try{for(const e of t)await v.addQuestion({...e,type:"essay"});i.success("导入成功"),r()}catch{i.error("导入失败")}},B=async()=>{var t;try{const e=await w.value.validate();(t=_.value)!=null&&t.id?(await v.updateQuestion(_.value.id,e),i.success("更新成功")):(await v.addQuestion(e),i.success("添加成功")),p.value=!1,r()}catch{i.error("操作失败")}};return r(),(t,e)=>{const E=d("a-button"),N=d("a-input-search"),C=d("a-space"),D=d("a-popconfirm"),O=d("a-table"),R=d("a-modal");return m(),h("div",H,[a("div",J,[l(C,null,{default:c(()=>[l(E,{type:"primary",onClick:z},{default:c(()=>e[2]||(e[2]=[j(" 新增简答题 ")])),_:1}),l(N,{value:s.value.keyword,"onUpdate:value":e[0]||(e[0]=o=>s.value.keyword=o),placeholder:"搜索题目",style:{width:"200px"},onSearch:b},null,8,["value"]),l(M,{onImport:V})]),_:1})]),l(O,{columns:Q,"data-source":q.value,loading:y.value,pagination:{total:x.value,current:s.value.current,pageSize:s.value.size,onChange:S,showSizeChanger:!0,showTotal:o=>`共 ${o} 条`,pageSizeOptions:["10","20","50","100"]}},{bodyCell:c(({column:o,record:u})=>[o.key==="title"?(m(),h("div",K,[a("div",W,k(u.question),1),a("div",X,[e[3]||(e[3]=a("strong",null,"参考答案：",-1)),a("div",Y,k(u.answer),1)]),u.explanation?(m(),h("div",Z,[e[4]||(e[4]=a("strong",null,"解析：",-1)),a("div",ee,k(u.explanation),1)])):g("",!0)])):g("",!0),o.key==="action"?(m(),F(C,{key:1},{default:c(()=>[a("a",{onClick:T=>$(u)},"编辑",8,te),l(D,{title:"确定要删除这道题目吗？",onConfirm:T=>I(u.id)},{default:c(()=>e[5]||(e[5]=[a("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):g("",!0)]),_:1},8,["data-source","loading","pagination"]),l(R,{open:p.value,"onUpdate:open":e[1]||(e[1]=o=>p.value=o),title:f.value,onOk:B},{default:c(()=>[l(P,{ref_key:"formRef",ref:w,"initial-values":_.value,type:"essay"},null,8,["initial-values"])]),_:1},8,["open","title"])])}}},ie=L(ae,[["__scopeId","data-v-180779b3"]]);export{ie as default};
